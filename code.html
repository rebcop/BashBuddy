<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bash Buddy: By Rebecca Copeland</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Devicons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css">

    <!-- Prism CSS -->
    <link rel="stylesheet" href="/css/prism.css" />

    <!-- Custom CSS -->
    <link href="/css/site.css" rel="stylesheet" />
    <link href="/css/themes.css" rel=stylesheet />


    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/rebeccacopeland-favicon.png" type="image/x-icon" />

</head>

<!-- CHANGE THEME ACCORDINGLY TO LOGO -->

<body data-rc-theme="sunset">

    <!-- #region navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/index.html">
                <img src="/img/Rebecca-Copeland-logo-white.svg" height="30" />
                Bash Buddy
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="/index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/app.html">The App</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="/code.html">The Code</a>
                    </li>
                    <li class="nav-item">
                        <!-- CHANGE ME TO THE REAL REPO LINK -->
                        <a class="nav-link" href="https://github.com/rebcop/BashBuddy" target="_blank">The Repo</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://rebcop.dev/" target="_blank">Portfolio</a>
                    </li>
                    <li class="nav-item">
                        <!-- CHANGE ME TO THE DEPLOYED BLOG PROJECT -->
                        <!-- NOTE: it would be a great idea to write a blog and
                        link here -->
                        <a class="nav-link disabled d-none" href="" target="_blank">Blog</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- #endregion navbar -->

    <main class="container py-3">
        <h2 class="border-bottom border-2 border-secondary-subtle">The Code</h2>
        <div class="row">
            <div class="col-12 col-lg-8">
                <pre class="line-numbers">
                    <code class="language-js">
                    // Test Data
                    const events = [
                    {
                        event: "ComicCon",
                        city: "New York",
                        state: "New York",
                        attendance: 240000,
                        date: "06/01/2017",
                    },
                    {
                        event: "ComicCon",
                        city: "New York",
                        state: "New York",
                        attendance: 250000,
                        date: "06/01/2018",
                    },
                    {
                        event: "ComicCon",
                        city: "New York",
                        state: "New York",
                        attendance: 257000,
                        date: "06/01/2019",
                    },
                    {
                        event: "ComicCon",
                        city: "San Diego",
                        state: "California",
                        attendance: 130000,
                        date: "06/01/2017",
                    },
                    {
                        event: "ComicCon",
                        city: "San Diego",
                        state: "California",
                        attendance: 140000,
                        date: "06/01/2018",
                    },
                    {
                        event: "ComicCon",
                        city: "San Diego",
                        state: "California",
                        attendance: 150000,
                        date: "06/01/2019",
                    },
                    {
                        event: "HeroesCon",
                        city: "Charlotte",
                        state: "North Carolina",
                        attendance: 40000,
                        date: "06/01/2017",
                    },
                    {
                        event: "HeroesCon",
                        city: "Charlotte",
                        state: "North Carolina",
                        attendance: 45000,
                        date: "06/01/2018",
                    },
                    {
                        event: "HeroesCon",
                        city: "Charlotte",
                        state: "North Carolina",
                        attendance: 50000,
                        date: "06/01/2019",
                    }];
                    
                    // Entry point of application, runs when the page loads
                    function buildDropDown() {
                    
                        // get all the events that we know about
                        let currentEvents = getEvents();
                    
                        // get a list of city names, using map and lambda expression
                        let eventCities = currentEvents.map(event => event.city);
                    
                        // Class constructor, take array of event cities which has dups and store only unique values as a set
                        let uniqueCities = new Set(eventCities);
                    
                        // spread operator [...], takes the set and spreads it out into another array with 'All' added at index 0
                        let dropdownChoices = ['All', ...uniqueCities];
                    
                        // Get template for dropdown before looping over each item
                        const dropdownTemplate = document.getElementById('dropdown-item-template');
                    
                        const dropdownMenu = document.getElementById('city-dropdown');
                    
                        // Clear out what's already in the menu before adding
                        dropdownMenu.innerHTML = '';
                    
                        // for each of those city names:
                        for ( let i=0; i &lt dropdownChoices.length; i++) {
                    
                            let cityName = dropdownChoices[i];
                    
                            // make a dropdown item HTML element
                            let dropdownItem = dropdownTemplate.content.cloneNode(true);
                            dropdownItem.querySelector('a').innerText = cityName;
                        
                            // add that element to the dropdown menu
                            dropdownMenu.appendChild(dropdownItem);
                        }
                        
                        displayEvents(currentEvents);
                    
                        displayStats(currentEvents);
                    
                        // reset table header name
                        document.getElementById('stats-location').textContent = 'All';
                    }
                    
                    // Grabs the latest events
                    function getEvents() {
                        // get events from local storage
                        let eventsJson = localStorage.getItem('rpc-events');
                    
                        // initialize stored events if someone hasn't been to the page before
                        let storedEvents = events;
                    
                        // check for events have been saved before
                        if (eventsJson == null) {
                            saveEvents(events);
                        } else {
                            storedEvents = JSON.parse(eventsJson);
                        }
                    
                        return storedEvents;
                    }
                    
                    // Save event added in modal to local storage
                    function saveEvents(events) {
                    
                        let eventsJson = JSON.stringify(events);
                    
                        // store in the browser for undetermined amount of time, can be seen and modified by anyone
                        localStorage.setItem('rpc-events', eventsJson);
                    }
                    

                    function displayEvents(events) {
                    
                        // get the table to put the events in
                        const eventTable = document.getElementById('eventsTable');
                    
                        // clear the table
                        eventTable.innerHTML = '';
                    
                        // loop through events
                        for (let i = 0; i &lt events.length ; i++) {
                    
                            let event = events[i];
                    
                            // make a &lttr>&lt/tr>
                            let eventRow = document.createElement('tr');
                    
                            // make a &lttd> for each property
                            // put the data into each &lttd> & append to row
                            let eventName = document.createElement('td');
                            eventName.innerText = event.event;
                            eventRow.appendChild(eventName);
                    
                            let eventCity = document.createElement('td');
                            eventCity.innerText = event.city;
                            eventRow.appendChild(eventCity);
                    
                            let eventState = document.createElement('td');
                            eventState.innerText = event.state;
                            eventRow.appendChild(eventState);
                    
                            let eventAttendance = document.createElement('td');
                            eventAttendance.innerText = event.attendance.toLocaleString();
                            eventRow.appendChild(eventAttendance);
                    
                            let eventDate = document.createElement('td');
                    
                            let date = new Date(event.date);
                    
                            eventDate.innerText = date.toLocaleDateString();
                            eventRow.appendChild(eventDate);
                            
                            // append the row to the &lttbody>
                            eventTable.appendChild(eventRow);
                        }
                    }
                    
                    function calculateStats(events) {
                    
                        let sum = 0;
                        let min = events[0].attendance;
                        let max = 0;
                    
                        for(let i = 0; i &lt events.length; i++) {
                            let event = events[i];
                    
                            sum += event.attendance;
                    
                            // Checks for the min attendance
                            if ( event.attendance &lt min ) {
                                min = event.attendance;
                            }
                    
                            // Checks for the max attendance
                            if ( event.attendance > max ) {
                                max = event.attendance;
                            }
                        }
                    
                        let avg = sum / events.length;
                    
                        // Shorter way to type objects if the properties are the same as the variable values
                        let stats = {
                            sum,
                            avg,
                            min,
                            max
                        }
                        return stats;
                    }
                    
                    function displayStats(events) {
                    
                        let stats = calculateStats(events);
                        // calculating and displaying the total attendance
                        document.getElementById('total-attendance').innerText = stats.sum.toLocaleString();
                    
                        // calculating and displaying the avg attendance
                        document.getElementById('avg-attendance').innerText = stats.avg.toLocaleString();
                    
                        // calculating and displaying and displaying the max attendance
                        document.getElementById('max-attended').innerText = stats.max.toLocaleString();
                    
                        // // calculating and displaying and displaying the min attendance
                        document.getElementById('min-attended').innerText = stats.min.toLocaleString();
                    }
                    
                    function filterByCity(element) {
                    
                        // get all the events
                        let cityName = element.textContent;
                    
                        // revise table header name
                        document.getElementById('stats-location').textContent = cityName;
                    
                        // get all the events
                        let allEvents = getEvents();
                    
                        // filter those events to just one city
                        let filteredEvents = [];
                    
                        for (let i = 0; i &lt allEvents.length; i++) {
                            let event = allEvents[i];
                    
                            if ( cityName == event.city || cityName == 'All' ) {
                                filteredEvents.push(event);
                            }
                    
                            // OTHER OPTION TYPE 1: Anonymous function with the filter method can be used to filter the array
                            // filteredEvents = allEvents.filter(function(event) {
                            //     if (event.city == cityName || cityName == 'All') {
                            //         return event;
                            //     } 
                            // })
                    
                            // OTHER OPTION TYPE 2: Lambda expression with the filter method can be used to filter the array below is the same as the for loop 
                            // if (cityName == 'All') {
                            //     filteredEvents = allEvents;
                            // } else {
                            //     filteredEvents = allEvents.filter(event => event.city == cityName)
                            // }
                        
                            // OTHER OPTION TYPE 3: Ternary statement
                            // let filteredEvents = cityName = 'All' ? allEvents : allEvents.filter(e => e.city == cityName);
                        }
                    
                        // call displayStats with the events for that city
                        displayStats(filteredEvents);
                    
                        // call displayEvents with the events for that city
                        displayEvents(filteredEvents);
                    }
                    
                    function saveNewEvent() {
                    
                        // Get HTML form element
                        let newEventForm = document.getElementById('newEventForm');
                        let formData = new FormData(newEventForm);
                    
                        // Creates an object from the &ltinput>s
                        // value of the property is the value of the input and the property is the name
                        // &ltinput name="city" value="kernersville" />
                        // let newEvent = { city: 'Kernersville}
                        let newEvent = Object.fromEntries(formData.entries());
                    
                        // change text to number for attendance
                        newEvent.attendance = parseInt(newEvent.attendance);
                    
                        // make sure all dates recieved are consistent in the way they're recieved
                        newEvent.date = new Date(newEvent.date).toLocaleDateString();
                    
                        // Grab the list of events
                        let allEvents = getEvents();
                    
                        // Add new event to list
                        allEvents.push(newEvent);
                    
                        // Save updated list of events
                        saveEvents(allEvents);
                    
                        // Resets the form so it goes back to how it was when page loaded
                        newEventForm.reset();
                    
                        displayEvents(allEvents);
                    
                        // hide the Bootstrap Modal
                        let modalElement = document.getElementById('addEventModal');
                        let bsModal = bootstrap.Modal.getInstance(modalElement);
                        bsModal.hide();
                    
                        // display all events
                        buildDropDown();
                    }
                    </code>
                </pre>
            </div>
            <div class="col-12 col-lg-4">
                <h4>TL;DR</h4>
                <p>
                    Use <code>localStorage.setItem()</code> & <code>localStorage.getItem()</code> to store information
                    in the browser.
                    This information is only accessible on the same browser it was saved in.
                </p>
                <h4>Code Explanation</h4>
                <p>Bash Buddy was created with the following functions:</p>
                <p>
                    <code>buildDropDown</code>
                </p>
                <p>
                    <code>getEvents</code>
                </p>
                <p>
                    <code>saveEvents</code>
                </p>
                <p>
                    <code>displayEvents</code>
                </p>
                <p>
                    <code>calculateStats</code>
                </p>
                <p>
                    <code>displayStats</code>
                </p>
                <p>
                    <code>filterByCity</code>
                </p>
                <p>
                    <code>saveNewEvent</code>
                </p>
                <p>

                </p>

                <h4>What I learned</h4>
                <ul>
                    <li>Use <code>map</code> to easily create an <span>array</span> of a spcific property from an
                        <span>array</span> of objects
                    </li>
                    <li>Use <code>Set</code> to provide an <span>array</span> that only contains unique values</li>
                    <li><code>localStorage.setItem()</code> & <code>localStorage.getItem()</code> allows for storing and
                        then getting information in the browser as a <span>JSON</span> for an undetermined amount of
                        time. This stoarge can be viewed and modified by anyone who has access to the same browserthe
                        information was stored in.</li>
                </ul>

                <h4>Improvements</h4>
                <ul>
                    <li>Ability to delete one / all events</li>
                    <li>Ability to filter by Event Name / Type, Date</li>
                    <li>Set up initial data with an <span>API</span></li>
                </ul>
            </div>
        </div>
    </main>

    <footer class="py-3">

        <div class="container">
            <div class="row align-items-center row-cols-1 row-cols-lg-3 gy-2">
                <div class="col text-center text-lg-start">
                    &copy; 2023 Rebecca Copeland
                </div>
                <div class="col text-center">
                    <a class="nav-link" href="https://rebcop.dev/" target="_blank"><img
                            src="/img/Rebecca-Copeland-full-logo-white.svg" height="40" /></a>
                </div>
                <div class="col text-center text-lg-end">
                    <a href="https://www.linkedin.com/in/rebcop/" target="_blank"><i class="bi bi-linkedin"></i></a>
                    <a href="https://github.com/rebcop" target="_blank"><i class="bi bi-github"></i></a>
                </div>
            </div>
        </div>

    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>

    <!-- Prism JS -->
    <script src="/js/prism.js"></script>
    <script>
        Prism.plugins.NormalizeWhitespace.setDefaults({
            'remove-trailing': true,
            'remove-indent': true,
            'left-trim': true,
            'right-trim': true
        })
    </script>

</body>

</html>